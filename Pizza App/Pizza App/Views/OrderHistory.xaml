<?xml version="1.0" encoding="utf-8" ?>
<ContentPage 
    xmlns="http://xamarin.com/schemas/2014/forms"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    x:Class="Pizza_App.Views.OrderHistory"
    Title="Order History"
    BackgroundColor="{AppThemeBinding Light={StaticResource BackgroundColor}, Dark={StaticResource BackgroundColorDark}}">

    <ContentPage.Resources>
        <ResourceDictionary>
            <!-- Delivered Status Style -->
            <Style x:Key="StatusLabelDelivered" TargetType="Label">
                <Setter Property="TextColor" Value="White" />
                <Setter Property="FontFamily" Value="Montserrat-SemiBold" />
                <Setter Property="FontSize" Value="12" />
                <Setter Property="Padding" Value="10,5" />
                <Setter Property="BackgroundColor" Value="#4CAF50" />
            </Style>

            <!-- In Progress Status Style -->
            <Style x:Key="StatusLabelInProgress" TargetType="Label">
                <Setter Property="TextColor" Value="White" />
                <Setter Property="FontFamily" Value="Montserrat-SemiBold" />
                <Setter Property="FontSize" Value="12" />
                <Setter Property="Padding" Value="10,5" />
                <Setter Property="BackgroundColor" Value="#2196F3" />
            </Style>

            <!-- Canceled Status Style -->
            <Style x:Key="StatusLabelCanceled" TargetType="Label">
                <Setter Property="TextColor" Value="White" />
                <Setter Property="FontFamily" Value="Montserrat-SemiBold" />
                <Setter Property="FontSize" Value="12" />
                <Setter Property="Padding" Value="10,5" />
                <Setter Property="BackgroundColor" Value="#F44336" />
            </Style>
        </ResourceDictionary>
    </ContentPage.Resources>

    <!-- Main Layout -->
    <Grid RowDefinitions="Auto,*">
        <!-- Header -->
        <StackLayout Grid.Row="0" Padding="20,10">
            <Label Text="Order History" Style="{StaticResource HeaderLabel}" />
            <Label Text="Your past orders" Style="{StaticResource BodyLabel}" />
        </StackLayout>

        <!-- Order History List -->
        <RefreshView Grid.Row="1" x:Name="OrdersRefreshView">
            <CollectionView x:Name="OrdersCollectionView" Margin="20,0,20,20">
                <!-- Sample Data -->
                <CollectionView.ItemsSource>
                    <x:Array Type="{x:Type x:String}">
                        <x:String>Order #1234</x:String>
                        <x:String>Order #1235</x:String>
                        <x:String>Order #1236</x:String>
                        <x:String>Order #1237</x:String>
                        <x:String>Order #1238</x:String>
                    </x:Array>
                </CollectionView.ItemsSource>

                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <!-- Swipe to Delete -->
                        <SwipeView>
                            <SwipeView.RightItems>
                                <SwipeItems>
                                    <SwipeItem Text="Delete" BackgroundColor="{StaticResource PrimaryColor}" />
                                </SwipeItems>
                            </SwipeView.RightItems>

                            <!-- Card Layout: replaced PancakeView with Frame -->
                            <Frame CornerRadius="15"
                                   Margin="0,10"
                                   Padding="15"
                                   HasShadow="True"
                                   BackgroundColor="{AppThemeBinding Light={StaticResource BackgroundColor}, Dark={StaticResource SurfaceColorDark}}">

                                <Grid RowDefinitions="Auto,Auto,Auto" RowSpacing="10">
                                    <!-- Order Header -->
                                    <Grid Grid.Row="0" ColumnDefinitions="*,Auto">
                                        <!-- Binding the order name -->
                                        <Label Grid.Column="0"
                                               Text="{Binding .}"
                                               FontFamily="Montserrat-Bold"
                                               FontSize="18"
                                               TextColor="{AppThemeBinding Light={StaticResource TextPrimaryColor}, Dark={StaticResource TextPrimaryColorDark}}" />

                                        <!-- Example Status: "Delivered" -->
                                        <Label Grid.Column="1"
                                               Text="Delivered"
                                               Style="{StaticResource StatusLabelDelivered}" />
                                    </Grid>

                                    <!-- Order Date and Items -->
                                    <StackLayout Grid.Row="1" Spacing="5">
                                        <Label Text="March 15, 2023 - 7:30 PM"
                                               FontFamily="Montserrat-Regular"
                                               FontSize="14"
                                               TextColor="{AppThemeBinding Light={StaticResource TextSecondaryColor}, Dark={StaticResource TextSecondaryColorDark}}" />

                                        <BoxView HeightRequest="1"
                                                 Margin="0,5"
                                                 Color="{AppThemeBinding Light={StaticResource BorderColor}, Dark={StaticResource BorderColorDark}}" />

                                        <Label Text="1x Pepperoni Pizza (Small)"
                                               FontFamily="Montserrat-SemiBold"
                                               FontSize="14"
                                               TextColor="{AppThemeBinding Light={StaticResource TextPrimaryColor}, Dark={StaticResource TextPrimaryColorDark}}" />

                                        <Label Text="2x Margherita Pizza (Medium)"
                                               FontFamily="Montserrat-SemiBold"
                                               FontSize="14"
                                               TextColor="{AppThemeBinding Light={StaticResource TextPrimaryColor}, Dark={StaticResource TextPrimaryColorDark}}" />
                                    </StackLayout>

                                    <!-- Order Total & Reorder Button -->
                                    <Grid Grid.Row="2" ColumnDefinitions="*,Auto">
                                        <StackLayout Grid.Column="0" VerticalOptions="Center">
                                            <Label Text="Total"
                                                   FontFamily="Montserrat-Regular"
                                                   FontSize="12"
                                                   TextColor="{AppThemeBinding Light={StaticResource TextSecondaryColor}, Dark={StaticResource TextSecondaryColorDark}}" />
                                            <Label Text="$42.97"
                                                   FontFamily="Montserrat-Bold"
                                                   FontSize="16"
                                                   TextColor="{AppThemeBinding Light={StaticResource PrimaryColor}, Dark={StaticResource PrimaryColorDark}}" />
                                        </StackLayout>

                                        <Button Grid.Column="1"
                                                Text="Reorder"
                                                BackgroundColor="{AppThemeBinding Light={StaticResource PrimaryColor}, Dark={StaticResource PrimaryColorDark}}"
                                                TextColor="White"
                                                CornerRadius="20"
                                                Padding="15,10" />
                                    </Grid>
                                </Grid>
                            </Frame>
                        </SwipeView>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </RefreshView>
    </Grid>
</ContentPage>
